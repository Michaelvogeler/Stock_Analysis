# Stock_Analysis

For this challenge, we were asked to Crete an excel macro with VBA coding to loop through all the stocks and recognize specific data from each line. While it was very challenging, I was able to finally put together a VBA code that successfully runs through the macro loop. 

First, I started by defining all the variables, and also added "For Each ws In Worksheets" so that the loop would run on all three sheets of the file. Then, I initialized the loop start on the second row, where the first line of data was. I made it loop from line 2 down through line 753,001 (the last row of data). The first iteration gathers total stock volume, where it starts at a value of "0", then adds row by row of column 7's total stock volume. Then, I made an If statement that identifies if a new ticker was identified. If the last row of the rocker is identified, then that ticker is used for the second table starting in column 9, along with a function to subtract the "close" from that last row, from the "open" in the first row of the same ticker. This gives the "yearly_change" and "percent_change" (percent change is yearly_change_close - yearly_change_open / yearly_change_open). Then, I output these values to the new table in columns 9, 10, 11, and 12. I changed the format to percentages using ".NumberFormat". The color conditions are simple: if the change is less than 0, then it turns the interior red, and if it is positive, it turns green. Overall, I had to trial and error with many different codes and functions to find the right solutions. It took a very, very long time. 